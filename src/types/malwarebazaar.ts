/**
 * MalwareBazaar API Type Definitions
 * Documentation: https://bazaar.abuse.ch/api/
 */

/**
 * MalwareBazaar Query Response
 * Returned by hash query endpoint
 */
export interface MalwareBazaarQueryResponse {
  query_status: 'ok' | 'no_results' | 'illegal_hash' | 'invalid_api_key';
  data?: MalwareBazaarSample[];
}

/**
 * Individual malware sample information
 */
export interface MalwareBazaarSample {
  sha256_hash: string;
  sha1_hash: string;
  md5_hash: string;
  first_seen: string;
  last_seen: string;
  file_name: string;
  file_size: number;
  file_type_mime: string;
  file_type: string;
  reporter: string;
  origin_country: string;
  signature?: string;
  imphash?: string;
  ssdeep?: string;
  tlsh?: string;
  tags?: string[];
  code_sign?: CodeSignInfo[];
  intelligence?: IntelligenceInfo;
  delivery_method?: string;
  comment?: string;
}

/**
 * Code signing information
 */
export interface CodeSignInfo {
  subject_cn: string;
  issuer_cn: string;
  serial_number: string;
  algorithm: string;
  valid_from: string;
  valid_to: string;
}

/**
 * Threat intelligence information
 */
export interface IntelligenceInfo {
  clamav?: string[];
  downloads: number;
  uploads: number;
  mail_collection?: string[];
}

/**
 * MalwareBazaar Error Response
 */
export interface MalwareBazaarErrorResponse {
  query_status: 'invalid_api_key' | 'illegal_hash' | 'no_results';
}

/**
 * Statistics calculated from MalwareBazaar response
 */
export interface MalwareBazaarAnalysisStats {
  totalSamples: number;
  uniqueSignatures: string[];
  fileTypes: string[];
  tags: string[];
  firstSeen?: string;
  lastSeen?: string;
  hasCodeSigning: boolean;
  totalDownloads: number;
  totalUploads: number;
}

/**
 * File type categories for classification
 */
export enum MalwareBazaarFileType {
  PE32 = 'exe',
  DLL = 'dll',
  APK = 'apk',
  JAR = 'jar',
  DMG = 'dmg',
  MSI = 'msi',
  RAR = 'rar',
  ZIP = 'zip',
  SCRIPT = 'script',
  OFFICE = 'office',
  OTHER = 'other',
}

/**
 * Delivery method categories
 */
export const DELIVERY_METHOD_LABELS: Record<string, string> = {
  'email_attachment': 'Email Attachment',
  'email_link': 'Email Link',
  'web_download': 'Web Download',
  'web_drive-by': 'Drive-by Download',
  'other': 'Other',
};

/**
 * Common malware tags for categorization
 */
export const MALWARE_TAG_CATEGORIES: Record<string, string> = {
  'ransomware': 'Ransomware',
  'trojan': 'Trojan',
  'rat': 'Remote Access Trojan',
  'stealer': 'Information Stealer',
  'loader': 'Malware Loader',
  'miner': 'Cryptocurrency Miner',
  'backdoor': 'Backdoor',
  'rootkit': 'Rootkit',
  'worm': 'Worm',
  'botnet': 'Botnet',
  'spyware': 'Spyware',
  'adware': 'Adware',
};
